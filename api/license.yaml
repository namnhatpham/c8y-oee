# yaml-language-server: $schema=https://raw.githubusercontent.com/reubenmiller/go-c8y-cli/feat/extensions-manager/tools/schema/extensionCommands.json
---
group:
  name: license
  description: OEE license management
commands:
  - name: install
    description: Install APAMA license
    descriptionLong: Install a new APAMA license. The APAMA license is an XML file provided by Software AG.
    method: PUT
    path: tenant/options/apama/custom.license
    exampleList:
      - description: install license for OEE APAMA
        command: c8y oee license install --file "C:\path\to\license\file\ApamaServerPAQLicense101_Example.xml"
    body:
      - name: file
        type: fileContentsAsString
        description: License file
    bodyTemplates:
      - type: jsonnet
        template: | 
          // Loop over fromArray (of strings), running std.stdReplace()
          local strReplaceMany(str, fromArray, to) = std.foldl( 
            function(retStr, from) std.strReplace(retStr, from, to), 
            fromArray, 
            str 
          ); 
          
          { 
            file:: null, 
            value: std.stripChars( 
              std.escapeStringJson( 
                strReplaceMany($.file, ['\r', '\n'], '') 
              ), 
              '\"' 
            ), 
          }